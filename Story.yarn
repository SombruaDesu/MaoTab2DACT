
//æ¸¸æˆå¼€å§‹æ—¶çš„ç¬¬ä¸€æ®µå¯¹è¯
title: FirstAct
---
luz: â€¦â€¦
luz: ä½ çš„ç¡çœ è´¨é‡å¾ˆå¥½ï¼Œä½†æ˜¯å¦‚æœå†è¿™æ ·å¥½ä¸‹å»çš„è¯
luz: æˆ‘é©¬ä¸Šå°±è¦é¥¿æ­»äº†ã€‚æ‹œæ‰˜ï¼Œé†’è¿‡æ¥å§
Player:è¿™é‡Œæ²¡æœ‰åˆ«äºº
<<if !has_level_tag("this","finished")&& !has_level_tag("this","finished1")&& !has_level_tag ("this","finished2")>>
    ->ä½ æ˜¯è°<<if !has_level_tag("this","finished")>>
        luz: å®è§‚æ¥è¯´ï¼Œâ€œæˆ‘â€æ˜¯å‰æ–‡æ˜çš„å­å—£ï¼Œæ˜¯æœ€åçš„èˆ¹åªï¼Œä½ çš„ä¼‘çœ èˆ±ï¼Œå°å²›ä¹‹å˜´â€¦â€¦
        luz: ä½†å¦‚æœä½ æƒ³çŸ¥é“çš„æ˜¯â€œè°é—®ä½ äº†â€ï¼Œé‚£å°±æ˜¯ä½ çœ¼å‰çš„ç‚‰å­ã€‚
        <<add_level_tag "this" "finished">>
    ->ç°åœ¨æ˜¯ä»€ä¹ˆæ—¶å€™<<if !has_level_tag("this","finished1")>>
        luz: å¦‚æœæ²¡è®°é”™ï¼Œè·ç¦»ä½ çš„æ—¶ä»£å·²ç»è¿‡å»ä¸‰åƒå¹´äº†ã€‚
        <<add_level_tag "this" "finished1">>
    ->ä»€ä¹ˆå«è¦é¥¿æ­»äº†<<if !has_level_tag("this","finished2")>>
        luz:ä½ ä¸éœ€è¦åƒé¥­å—ï¼Ÿâ€¦â€¦å“¦ï¼Œèµ·ç åœ¨å±å¹•é‡Œä¸ç”¨ã€‚
        luz:ä½†æ˜¯æˆ‘éœ€è¦åƒï¼Œå‰æ–‡æ˜æ—¶æœŸä½ çš„æ—äººæŠŠæ‰‹ä¸­å…¨éƒ¨çš„**ç‡ƒæ–™**éƒ½å–‚ç»™äº†æˆ‘ï¼Œæˆ‘æ‰èƒ½æ´»åˆ°ç°åœ¨ã€‚
        luz:ä¸ºäº†ç»´æŒå°½å¯èƒ½ä¹…çš„ç”Ÿå‘½ï¼Œä¸‰åƒå¹´é‡Œæˆ‘åƒæ— é”šçš„èˆ¹ä¸€æ ·éšæ³¢é€æµï¼Œå¸Œæœ›å¤©ç¾èƒ½åœ¨ç‡ƒæ–™è€—å°½å‰è¿‡å»ã€‚
        luz:å¾ˆé—æ†¾ï¼Œäººç±»äº‹å…ˆåšå‡ºçš„å‡†å¤‡æ¯”èµ·ä»–ä»¬æ…ä¸‹çš„å¨„å­æ¥è¯´ï¼Œè¿˜æ˜¯å¤ªå¾®ä¸è¶³é“äº†ã€‚
        luz:æˆ‘æ²¡æœ‰è§…é£Ÿèƒ½åŠ›ã€‚åœ¨è¿™æœ€åçš„ç«ç§ä¹Ÿç†„ç­ä¹‹å‰ï¼Œä½ å¾—å–‚æˆ‘ç‚¹ä¸œè¥¿ã€‚
        luz:åˆ°ä¸Šé¢å»å§ï¼Œçœ‹çœ‹ä½ çš„æ—äººæœ‰æ²¡æœ‰å‰©ä¸‹ä»€ä¹ˆã€‚
        luz:é¡ºä¾¿ï¼Œæˆ‘æœ‰ç§é™Œç”Ÿçš„æ„Ÿè§‰ï¼Œè¿™ç§æ„Ÿè§‰å¾ˆä¹…æ²¡æœ‰è¿‡äº†â€”â€”  æˆ‘æƒ³ï¼Œä¸Šé¢æ˜¯æœ‰å®¢äººæ¥äº†ã€‚
        <<add_level_tag "this" "finished2">>
<<else>>
    <<end>>
    //ä¸‰ä¸ªå¯¹è¯å®Œæˆï¼Œè§’è‰²èµ°ä¸Šæ¥¼å»ï¼Œå¤–é¢æ­¤åˆ»æ˜¯æš´é›¨ä½†å¹¶æ²¡æœ‰æ¨¡ç³Šè§†çº¿
<<endif>>
===


//ä¸»è§’èµ°åˆ°å¥³å­©é™„è¿‘
title: FirstAct2
---
Girl: â€¦â€¦ï¼ï¼
Girl:ï¼ˆè¿…é€Ÿæ‰“é‡ä½ ä¸€çœ¼ï¼‰ä½ ã€ä½ çš„æ ·å­â€¦â€¦ä¸å¤ªä¸€æ ·ï¼Œä½ â€¦â€¦ä½ æ˜¯â€¦â€¦ä»€ä¹ˆä¸œè¥¿â€¦â€¦ï¼Ÿ
Player:å¥¹æ²¡æƒ³åˆ°è¿™é‡Œæœ‰äººâ€¦â€¦ä¸ï¼Œå¥¹æ²¡è§è¿‡æ²¡æœ‰ç¿…è†€çš„äººç§ã€‚ä½†æ˜¯è¯´å®è¯ï¼Œæˆ‘ä¹Ÿæ²¡è§è¿‡æœ‰ç¿…è†€çš„äººç§ã€‚
->äººç±»â€¦â€¦æˆ–è€…è¯´ï¼Œç”±çŒ¿äººæ¼”å˜ä¸ºçš„é‚£ä¸€æ”¯ã€‚
    Girl: (ï¼ˆæˆ’å¤‡ï¼‰åœ†äººæ˜¯ä»€ä¹ˆä¸œè¥¿â€¦â€¦ï¼Ÿâ€¦â€¦åœ†ï¼Ÿå“ªé‡Œåœ†äº†â€¦â€¦ï¼Ÿ
    Player:â€¦â€¦ä½ æ˜¯åæ–‡æ˜æ—¶ä»£çš„äººå—ï¼Ÿâ€¦â€¦ç®—äº†ï¼Œçœ‹æ¥æ˜¯çš„ã€‚
    Girl: (ï¼ˆæˆ’å¤‡ï¼‰ä½ ä¸ºä»€ä¹ˆç©¿æˆè¿™æ ·ï¼Ÿ
    Player:â€¦â€¦è¿™æ˜¯å‰æ–‡æ˜ç”¨æ¥åº”å¯¹å¤©ç¾çš„è£…å¤‡ã€‚*ï¼ˆè™½ç„¶ï¼Œè¿™æ ·çš„è£…å¤‡åœ¨å¤©ç¾é¢å‰â€¦â€¦ï¼‰*
    Girl: (ï¼ˆçš±ç€çœ‰ï¼‰â€¦â€¦ä½ è¿™äººè¯´è¯å¥‡å¥‡æ€ªæ€ªçš„ã€‚æˆ‘çš„æ—äººä»æ¥ä¸è¿™æ ·è¯´è¯ã€‚
    Player:ï¼ˆæ— å¥ˆï¼‰æŠ±æ­‰ï¼Œæˆ‘æ—äººçš„è¯´è¯ä¹ æƒ¯æ˜¯è¿™æ ·çš„ã€‚
->å½“ä»Šç¤¾ä¼šå·²ç»æ²¡æœ‰äººç±»äº†å—ï¼Ÿï¼Ÿï¼Ÿ<<if !has_level_tag("this","FirstActFinished")>>
    Girl: (ï¼ˆè¿·æƒ‘ï¼‰â€¦â€¦è›‡ä¼šâ€¦â€¦ä»€ä¹ˆï¼Ÿ
    Player:*ï¼ˆæˆ‘ä»¬å¿…é¡»æ„è¯†åˆ°å‰æ–‡æ˜çš„è¯­æ–™åº“å·²ç»ç»™å‰æ–‡æ˜æ®‰è‘¬å»äº†ã€‚ï¼‰
    <<add_level_tag "this" "FirstActFinished">>
->æ²‰é»˜ä¸è¯­ï¼Œåªæ˜¯å¹³é™åœ°çœ‹ç€å¥¹ï¼‰
    Player:ï¼ˆå¥¹é•¿å¾—åƒåå²å·¦å³çš„äººç±»å°å­©ï¼Œä½†å‘è‰²å’Œæ‰“æ‰®éƒ½ä¸å‰æ–‡æ˜è¿¥å¼‚ã€‚ä½ çœ‹åˆ°å¥¹èƒŒåæœ‰ä¸€å¯¹ç±»ä¼¼é¸Ÿç±»çš„ç¾½ç¿¼ï¼Œä½†æ˜¯ä¸Šé¢ç¾½æ¯›çš„è´¨åœ°å’Œä½ ä»¥å‰çš„è®¤çŸ¥ä¸å¤ªä¸€æ ·â€¦â€¦ä»¥åŠï¼Œç°åœ¨æµè¡Œå¾€ç¿…è†€ä¸Šæ’æ ‘å¶å½“è£…é¥°å—ï¼Ÿï¼‰
    Girl: (é€æ¸å¹³é™ä¸‹æ¥ï¼Œä½†ä»ç–‘æƒ‘åœ°æ‰“é‡ç€ä½ ï¼‰â€¦â€¦å’¦ï¼Œå¯ä»¥å¬åˆ°å—ï¼Ÿ
    ->å¯ä»¥ã€‚åˆšæ‰å“åˆ°ä½ äº†å—ï¼Ÿ
        Girl:ï¼ˆç¨å¾®æ”¾æ¾ä¸‹æ¥ï¼‰å“¦â€¦â€¦æˆ‘ï¼Œæˆ‘æ²¡æƒ³åˆ°ä½ åœ¨è¿™é‡Œâ€¦â€¦
Player:è¿™ä¹ˆå¤§çš„é›¨ï¼Œä½ æ˜¯æ€ä¹ˆè¿‡æ¥çš„ï¼Ÿ
Girl:ï¼ˆä½ä¸‹å¤´ï¼‰â€¦â€¦**é›¨åœçš„æ—¶å€™**æˆ‘é£è¿‡æ¥ç©ï¼Œç©ç€ç©ç€ï¼Œé›¨åˆå¼€å§‹ä¸‹äº†â€¦â€¦æˆ‘ä»¬ä¸èƒ½åœ¨é›¨å¤©æ´»åŠ¨â€¦â€¦
Player:é›¨ä¼šåœä¸‹æ¥ï¼Ÿ
Girl:é›¨å½“ç„¶ä¼šåœå•¦ï¼Œä¸ä¸‹é›¨çš„æ—¶å€™æˆ‘çš„æ—äººä»¬å‡ºå»æ‰“çŒï¼Œä¸‹é›¨äº†å°±å›å®¶ã€‚æˆ‘â€¦â€¦
Girl:ï¼ˆå¹æ°”ï¼‰æˆ‘ä¸éœ€è¦æ‰“çŒã€‚
Player:ï¼ˆçœ‹çœ‹å¤©è‰²ï¼‰ç°åœ¨é›¨è¿˜æ²¡æœ‰åœä¸‹æ¥çš„è¿¹è±¡ï¼Œæˆ‘ä»¬å»åœ°ä¸‹ç­‰å§ã€‚åœ°ä¸‹æœ‰ç«ç‚‰ï¼Œä¼šæ¸©æš–ä¸€äº›ã€‚
Girl:â€¦â€¦æ´»é¹¿ï¼Ÿ
Player:å‘ƒâ€¦â€¦ä¸æ˜¯åŠ¨ç‰©ï¼Œæ˜¯å‰æ–‡æ˜ç•™ä¸‹æ¥çš„å…‰æºå’Œçƒ­æºâ€¦â€¦æˆ‘æ˜¯è¯´ï¼Œä¸€ç§å£³å­ç¡¬ç¡¬çš„ï¼Œé‡Œé¢çƒ«çƒ«çš„ã€äº®äº®çš„ä¸œè¥¿ã€‚
Girl:ï¼ˆçåœ†çœ¼ç›ï¼‰å“‡ï¼Œå¬èµ·æ¥åƒâ€¦â€¦æŸç§æµ·èºï¼Ÿå¯æ˜¯æˆ‘ä»æ¥æ²¡è§è¿‡è¿™æ ·çš„ï¼
Player:ï¼ˆè¯ç©·ï¼‰å—¯â€¦â€¦
Girl:é‚£å¥½å§ï¼Œæˆ‘æƒ³è¦çœ‹çœ‹ä½ è¯´çš„â€œæ´»èºâ€â€¦â€¦ä½ æ˜¯ä»é‚£è¾¹çš„æ´é‡Œçˆ¬ä¸Šæ¥çš„ï¼Œå¯¹å—ï¼Ÿ        
<<end>>
===






title: Node_Start
position: 265,191
---
<<end>>
===

title: Node_TestDlg
position: 271,421
group: TestLevel
---
<<if has_level_tag("this","å·²ç»è·ŸFoxå¯¹è¯äº†")>>
    <<end>>
<<endif>>
// è°ƒç”¨GDSæ£€æµ‹ç©å®¶æ˜¯åœ¨NPCçš„å‰é¢è¿˜æ˜¯åé¢
<<define>>
Â·extends Node
Â·func _ready():
Â·   var node = GameState.GetLevelNode("Path2D/PathFollow2D/ITestZone/Sprite2D") as Node2D
Â·   GameState.StorageNode("fox",node)
Â·   if GameState.GetPlayer().position.x < node.global_position.x:
Â·       GameState.AddLevelTag("this","ç©å®¶åœ¨Foxçš„èº«å")
Â·   queue_free()
<<do>>
<<if has_level_tag("this","ç©å®¶åœ¨Foxçš„èº«å")>>
    å””ï¼Œæ˜¯è°åœ¨æˆ‘åé¢ï¼Ÿ
    // è°ƒç”¨GDSè®©NPCçš„æ¨¡å‹ç¿»è½¬é¢å‘ç©å®¶
    <<define>>
    Â·extends Node
    Â·func _ready():
    Â·   var node = GameState.PeekNode("fox") as AnimatedSprite2D
    Â·   node.flip_h = true
    Â·   queue_free()
    <<do>>
    å•Šï¼Œæ˜¯ä½ å•Šï¼Œæ—©ä¸Šå¥½ï¼
    <<jump Node_TestDlg2>>
<<endif>>
æ—©ä¸Šå¥½ï¼
<<jump Node_TestDlg2>>
===

title: Node_TestDlg2
position: 275,720
group: TestLevel
---
->Player:ä½ è¿™æ˜¯æ€ä¹ˆäº†ï¼Ÿ
å“¦ï¼ä¸ç”¨åœ¨æ„ï¼Œé‚£æ˜¯æˆ‘åœ¨ç»ƒä¹ å•è„šç«™ç«‹ï¼
è¯´åˆ°è¿™ä¸ªï¼Œæˆ‘æœ€è¿‘æ„Ÿè§‰åˆæå‡äº†ä¸å°‘ï¼Œæˆ‘ä»¬èµ¶å¿«å»è¯•è¯•å§ã€‚
<<add_level_tag "this" "å·²ç»è·ŸFoxå¯¹è¯äº†">>
<<pass>>
<<define>>
Â·extends Node
Â·func _ready():
Â·   var node = GameState.PeekNode("fox") as AnimatedSprite2D;
Â·   if GameState.HasLevelTag("this","ç©å®¶åœ¨Foxçš„èº«å"):
Â·       node.flip_h = false
Â·   var player = GameState.GetLevelNode("Path2D/PathFollow2D/ITestZone/AnimationAsyncPlayer") as AnimationAsyncPlayer;
Â·   player.Play("Move",1)
Â·   GameState.AddLevelTag("this","Foxèµ°åˆ°è¾¹ä¸Š");
Â·   await player.OnAnimationFinished;
Â·   queue_free()
<<do>>
===

title: Node_GoTest2
position: 14,561
group: TestLevel
---
<<define>>
Â·extends Node
Â·func _ready():
Â·   var node = GameState.PeekNode("fox") as AnimatedSprite2D;
Â·   if GameState.HasLevelTag("this","ç©å®¶åœ¨Foxçš„èº«å"):
Â·       node.flip_h = false
Â·   var player = GameState.GetLevelNode("Path2D/PathFollow2D/ITestZone/AnimationAsyncPlayer") as AnimationAsyncPlayer;
Â·   player.Play("Move",1)
Â·   GameState.AddLevelTag("this","Foxèµ°åˆ°è¾¹ä¸Š");
Â·   await player.OnAnimationFinished;
Â·   queue_free()
<<do>>
===

title: Node_WaitTest
position: 56,54
---
ä½ å¥½
->æ²‰é»˜
    æ€ä¹ˆä¸è¯´è¯å•Šè¿™ç‹
->ä½ ä¹Ÿå¥½
    å¥½å¥½å¥½

<<define>>
Â·extends Node
Â·func _ready():
Â·   if GameState.GetPlayer().GetItem("ç«ç§") != null:
Â·       GameState.AddLevelTag("this","Foxæœ‰ç«ç§")
Â·   else:
Â·       GameState.RemoveLevelTag("this","Foxæœ‰ç«ç§")
Â·   queue_free()
<<do>>
<<if has_level_tag("this","Foxæœ‰ç«ç§")>>
    ä½ æ€ä¹ˆèƒŒç€æˆ‘æƒ³è¦çš„ä¸œè¥¿ï¼
    æŠŠå®ƒäº¤å‡ºæ¥ï¼
    ->äº¤å‡º
        <<define>>
        Â·extends Node
        Â·func _ready():
        Â·   var item = GameState.GetPlayer().GetItem("ç«ç§")
        Â·   GameState.GetPlayer().PlaceItemTo(item,Vector2(766,460),finish)
        Â·   pass
        Â·
        Â·func finish():
        Â·   queue_free()
        Â·
        <<do>>
<<else>>
    æ²¡ä»€ä¹ˆäº‹äº†ï¼Œä¸€è¾¹ç©å»å§ã€‚
<<endif>>
<<end>>
===

title: Node_CoreWork
position: 39,199
---
\[b\]ç‚‰å­\[/b\]\\nè¿™æ˜¯ä¸€ä¸ªç‚‰å­
<<define>>
Â·extends Node
Â·func _ready():
Â·   GameState.GetCamera().FollowPosition(Vector2(368,560))
Â·   GameState.GetCamera().SetZoom(2)
Â·   queue_free()
<<do>>
->å…³æ‰å®ƒğŸ†’
    <<define>>
    Â·extends Node
    Â·func _ready():
    Â·   if(GameState.GetInt("ç«åŠ›") >= 1):
    Â·       GameState.AddInt("ç«åŠ›",-1)
    Â·   queue_free()
    <<do>>
->åŠ å¤§ç«åŠ›
    <<define>>
    Â·extends Node
    Â·func _ready():
    Â·   if(GameState.GetInt("ç«åŠ›") < 2):
    Â·       GameState.AddInt("ç«åŠ›",1)
    Â·   queue_free()
    <<do>>

<<define>>
    Â·extends Node
    Â·func _ready():
    Â·   var player = GameState.GetLevelNode("coreFurnace") as AnimatedSprite2D
    Â·   player.play("Work" + str(GameState.GetInt("ç«åŠ›")))
    Â·   GameState.GetCamera().FollowTarget(GameState.GetPlayer())
	Â·   GameState.GetCamera().SetZoom(1.6)
    Â·   queue_free()
<<do>>
<<end>>
===