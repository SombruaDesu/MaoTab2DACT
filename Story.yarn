title: Node_Start
position: 265,191
---
<<end>>
===

title: Node_TestDlg
position: 271,421
group: TestLevel
---
<<if has_level_tag("this","å·²ç»è·ŸFoxå¯¹è¯äº†")>>
    <<end>>
<<endif>>
// è°ƒç”¨GDSæ£€æµ‹ç©å®¶æ˜¯åœ¨NPCçš„å‰é¢è¿˜æ˜¯åé¢
<<define>>
Â·extends Node
Â·func _ready():
Â·   var node = GameState.GetLevelNode("Path2D/PathFollow2D/ITestZone/Sprite2D") as Node2D
Â·   GameState.StorageNode("fox",node)
Â·   if GameState.GetPlayer().position.x < node.global_position.x:
Â·       GameState.AddLevelTag("this","ç©å®¶åœ¨Foxçš„èº«å")
Â·   queue_free()
<<do>>
<<if has_level_tag("this","ç©å®¶åœ¨Foxçš„èº«å")>>
    å””ï¼Œæ˜¯è°åœ¨æˆ‘åé¢ï¼Ÿ
    // è°ƒç”¨GDSè®©NPCçš„æ¨¡å‹ç¿»è½¬é¢å‘ç©å®¶
    <<define>>
    Â·extends Node
    Â·func _ready():
    Â·   var node = GameState.PeekNode("fox") as AnimatedSprite2D
    Â·   node.flip_h = true
    Â·   queue_free()
    <<do>>
    å•Šï¼Œæ˜¯ä½ å•Šï¼Œæ—©ä¸Šå¥½ï¼
    <<jump Node_TestDlg2>>
<<endif>>
æ—©ä¸Šå¥½ï¼
<<jump Node_TestDlg2>>
===

title: Node_TestDlg2
position: 275,720
group: TestLevel
---
->Player:ä½ è¿™æ˜¯æ€ä¹ˆäº†ï¼Ÿ
å“¦ï¼ä¸ç”¨åœ¨æ„ï¼Œé‚£æ˜¯æˆ‘åœ¨ç»ƒä¹ å•è„šç«™ç«‹ï¼
è¯´åˆ°è¿™ä¸ªï¼Œæˆ‘æœ€è¿‘æ„Ÿè§‰åˆæå‡äº†ä¸å°‘ï¼Œæˆ‘ä»¬èµ¶å¿«å»è¯•è¯•å§ã€‚
<<add_level_tag "this" "å·²ç»è·ŸFoxå¯¹è¯äº†">>
<<pass>>
<<define>>
Â·extends Node
Â·func _ready():
Â·   var node = GameState.PeekNode("fox") as AnimatedSprite2D;
Â·   if GameState.HasLevelTag("this","ç©å®¶åœ¨Foxçš„èº«å"):
Â·       node.flip_h = false
Â·   var player = GameState.GetLevelNode("Path2D/PathFollow2D/ITestZone/AnimationAsyncPlayer") as AnimationAsyncPlayer;
Â·   player.Play("Move",1)
Â·   GameState.AddLevelTag("this","Foxèµ°åˆ°è¾¹ä¸Š");
Â·   await player.OnAnimationFinished;
Â·   queue_free()
<<do>>
===

title: Node_GoTest2
position: 14,561
group: TestLevel
---
<<define>>
Â·extends Node
Â·func _ready():
Â·   var node = GameState.PeekNode("fox") as AnimatedSprite2D;
Â·   if GameState.HasLevelTag("this","ç©å®¶åœ¨Foxçš„èº«å"):
Â·       node.flip_h = false
Â·   var player = GameState.GetLevelNode("Path2D/PathFollow2D/ITestZone/AnimationAsyncPlayer") as AnimationAsyncPlayer;
Â·   player.Play("Move",1)
Â·   GameState.AddLevelTag("this","Foxèµ°åˆ°è¾¹ä¸Š");
Â·   await player.OnAnimationFinished;
Â·   queue_free()
<<do>>
===

title: Node_WaitTest
position: 56,54
---
ä½ å¥½
->æ²‰é»˜
    æ€ä¹ˆä¸è¯´è¯å•Šè¿™ç‹
->ä½ ä¹Ÿå¥½
    å¥½å¥½å¥½

<<define>>
Â·extends Node
Â·func _ready():
Â·   if GameState.GetPlayer().GetItem("ç«ç§") != null:
Â·       GameState.AddLevelTag("this","Foxæœ‰ç«ç§")
Â·   else:
Â·       GameState.RemoveLevelTag("this","Foxæœ‰ç«ç§")
Â·   queue_free()
<<do>>
<<if has_level_tag("this","Foxæœ‰ç«ç§")>>
    ä½ æ€ä¹ˆèƒŒç€æˆ‘æƒ³è¦çš„ä¸œè¥¿ï¼
    æŠŠå®ƒäº¤å‡ºæ¥ï¼
    ->äº¤å‡º
        <<define>>
        Â·extends Node
        Â·func _ready():
        Â·   var item = GameState.GetPlayer().GetItem("ç«ç§")
        Â·   GameState.GetPlayer().PlaceItemTo(item,Vector2(766,460),finish)
        Â·   pass
        Â·
        Â·func finish():
        Â·   queue_free()
        Â·
        <<do>>
<<else>>
    æ²¡ä»€ä¹ˆäº‹äº†ï¼Œä¸€è¾¹ç©å»å§ã€‚
<<endif>>
<<end>>
===

title: Node_CoreWork
position: 39,199
---
\[b\]ç‚‰å­\[/b\]\\nè¿™æ˜¯ä¸€ä¸ªç‚‰å­
<<define>>
Â·extends Node
Â·func _ready():
Â·   GameState.GetCamera().FollowPosition(Vector2(368,560))
Â·   GameState.GetCamera().SetZoom(2)
Â·   queue_free()
<<do>>
->å…³æ‰å®ƒğŸ†’
    <<define>>
    Â·extends Node
    Â·func _ready():
    Â·   if(GameState.GetInt("ç«åŠ›") >= 1):
    Â·       GameState.AddInt("ç«åŠ›",-1)
    Â·   queue_free()
    <<do>>
->åŠ å¤§ç«åŠ›
    <<define>>
    Â·extends Node
    Â·func _ready():
    Â·   if(GameState.GetInt("ç«åŠ›") < 2):
    Â·       GameState.AddInt("ç«åŠ›",1)
    Â·   queue_free()
    <<do>>

<<define>>
    Â·extends Node
    Â·func _ready():
    Â·   var player = GameState.GetLevelNode("coreFurnace") as AnimatedSprite2D
    Â·   player.play("Work" + str(GameState.GetInt("ç«åŠ›")))
    Â·   GameState.GetCamera().FollowTarget(GameState.GetPlayer())
	Â·   GameState.GetCamera().SetZoom(1.6)
    Â·   queue_free()
<<do>>
<<end>>
===